<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GenAI Artisan Assistant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f4f7fa;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border-left-color: #ffffff;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .nav-active {
            background-color: #4f46e5;
            color: #ffffff;
            box-shadow: 0 4px 14px 0 rgba(79, 70, 229, 0.3);
        }
        .sub-nav-active {
            color: #4f46e5;
            border-bottom-color: #4f46e5;
            font-weight: 600;
        }
        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #d1d5db;
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #9ca3af;
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="w-full h-screen grid grid-cols-1 md:grid-cols-4 xl:grid-cols-5">
        <!-- Left Side: Navigation -->
        <div class="bg-white/50 md:col-span-1 xl:col-span-1 p-6 flex flex-col border-r border-gray-200/80">
            <header class="mb-10">
                <h1 class="text-2xl font-bold text-gray-900 flex items-center">
                    <svg class="w-8 h-8 text-indigo-600 mr-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 14H9V8h2v8zm4 0h-2V8h2v8z"/></svg>
                    Artisan AI
                </h1>
            </header>

            <nav id="main-nav" class="flex flex-col space-y-3">
                <button class="nav-btn nav-active flex items-center p-3 rounded-lg font-semibold transition-all duration-200" data-section="story">
                    <svg class="w-5 h-5 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" /></svg>
                    Story Generator
                </button>
                <button class="nav-btn text-gray-600 hover:bg-gray-200/50 flex items-center p-3 rounded-lg font-semibold transition-all duration-200" data-section="seo">
                    <svg class="w-5 h-5 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.362 5.214A8.252 8.252 0 0112 21 8.25 8.25 0 016.038 7.048 8.287 8.287 0 009 9.6a8.983 8.983 0 013.369-2.23 8.287 8.287 0 003.369-2.154z" /><path stroke-linecap="round" stroke-linejoin="round" d="M12 12.75a3 3 0 100-6 3 3 0 000 6z" /></svg>
                    SEO & Tags
                </button>
                <button class="nav-btn text-gray-600 hover:bg-gray-200/50 flex items-center p-3 rounded-lg font-semibold transition-all duration-200" data-section="social">
                    <svg class="w-5 h-5 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M7.217 10.907a2.25 2.25 0 100 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186l9.566-5.314m-9.566 7.5l9.566 5.314m0 0a2.25 2.25 0 103.935 2.186 2.25 2.25 0 00-3.935-2.186zm0-12.814a2.25 2.25 0 103.933-2.186 2.25 2.25 0 00-3.933 2.186z" /></svg>
                    Social Posts
                </button>
                 <button class="nav-btn text-gray-600 hover:bg-gray-200/50 flex items-center p-3 rounded-lg font-semibold transition-all duration-200" data-section="image">
                    <svg class="w-5 h-5 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" /></svg>
                    Image Prompt
                </button>
                <hr class="my-4 border-gray-200">
                <button class="nav-btn text-gray-600 hover:bg-gray-200/50 flex items-center p-3 rounded-lg font-semibold transition-all duration-200" data-section="brand">
                    <svg class="w-5 h-5 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.438.995s.145.755.438.995l1.003.827c.48.398.668 1.03.26 1.431l-1.296 2.247a1.125 1.125 0 01-1.37.49l-1.217-.456c-.355-.133-.75-.072-1.075.124a6.57 6.57 0 01-.22.127c-.332.183-.582.495-.645.87l-.213 1.281c-.09.543-.56.94-1.11.94h-2.593c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.063-.374-.313-.686-.645-.87a6.52 6.52 0 01-.22-.127c-.324-.196-.72-.257-1.075-.124l-1.217.456a1.125 1.125 0 01-1.37-.49l-1.296-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.437-.995s-.145-.755-.437-.995l-1.004-.827a1.125 1.125 0 01-.26-1.431l1.296-2.247a1.125 1.125 0 011.37-.49l1.217.456c.355.133.75.072 1.075-.124.072-.044.146-.087.22-.127.332-.183.582-.495.645-.87l.213-1.281z" /><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                    Brand Hub
                </button>
            </nav>
        </div>

        <!-- Right Side: Workspace -->
        <div class="bg-gray-50 md:col-span-3 xl:col-span-4 p-8 flex flex-col h-screen">
            <div id="workspace" class="flex flex-col h-full">
                <!-- Workspace Header -->
                <div id="workspace-header" class="mb-6 fade-in">
                    <h2 id="workspace-title" class="text-3xl font-bold text-gray-800">Create a Product Story</h2>
                    <p id="workspace-subtitle" class="text-gray-500 mt-1">Generate a compelling narrative for your product.</p>
                </div>
                
                <!-- Social Sub-Navigation -->
                <nav id="social-sub-nav" class="hidden border-b border-gray-200 mb-6 fade-in">
                    <div class="flex space-x-6">
                        <button class="sub-nav-btn sub-nav-active py-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 transition" data-social="instagram">Instagram</button>
                        <button class="sub-nav-btn py-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 transition" data-social="facebook">Facebook</button>
                        <button class="sub-nav-btn py-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 transition" data-social="linkedin">LinkedIn</button>
                        <button class="sub-nav-btn py-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 transition" data-social="amazon">Amazon</button>
                    </div>
                </nav>

                <!-- Input Area -->
                <div id="input-container" class="fade-in">
                    <!-- Dynamic inputs will be injected here by JS -->
                </div>
                
                <!-- Generate Button -->
                <div class="mt-6 fade-in">
                    <button id="generateBtn" class="bg-indigo-600 text-white font-semibold py-3 px-6 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-4 focus:ring-indigo-300 transition-all transform hover:scale-105 flex items-center justify-center w-full md:w-auto">
                        <span id="btn-text">Generate Story</span>
                        <div id="loadingSpinner" class="hidden ml-3">
                            <div class="spinner"></div>
                        </div>
                    </button>
                </div>

                <!-- Output Area -->
                <div class="border-t border-gray-200 mt-8 pt-6 flex-grow flex flex-col">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Output</h3>
                    <div id="output" class="flex-grow overflow-y-auto pr-2 text-base leading-relaxed custom-scrollbar bg-white p-4 rounded-lg border border-gray-200">
                        <div class="flex flex-col items-center justify-center h-full text-center text-gray-400">
                            <svg class="w-16 h-16 mb-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.572L16.25 21.75l-.648-1.178a2.25 2.25 0 00-1.474-1.474L13 18.75l1.178-.648a2.25 2.25 0 001.474-1.474L16.25 15l.648 1.178a2.25 2.25 0 001.474 1.474L19.5 18l-1.178.648a2.25 2.25 0 00-1.474 1.474z" /></svg>
                            <p class="font-medium">Your generated content will appear here</p>
                            <p class="text-sm">Select a tool and provide some input to get started.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const workspaceConfig = {
            story: {
                title: 'Create a Product Story',
                subtitle: 'Generate a compelling narrative for your product.',
                btnText: 'Generate Story',
                inputs: [
                    { type: 'textarea', id: 'prompt', label: 'Product Description', placeholder: 'e.g., A hand-carved wooden rhino from Assam with intricate details...', rows: 8 }
                ]
            },
            seo: {
                title: 'Generate SEO & Tags',
                subtitle: 'Optimize your listing for search engines and marketplaces.',
                btnText: 'Generate SEO',
                inputs: [
                    { type: 'textarea', id: 'prompt', label: 'Product Description or Story', placeholder: 'Paste your product description or generated story here...', rows: 8 }
                ]
            },
            social: {
                instagram: {
                    title: 'Create an Instagram Post',
                    subtitle: 'Craft an engaging post for your Instagram audience.',
                    btnText: 'Generate Post',
                    inputs: [
                        { type: 'textarea', id: 'prompt', label: 'Core message or idea for the post', placeholder: 'e.g., Announcing a new limited edition rhino sculpture.', rows: 4 },
                        { type: 'text', id: 'hashtags', label: 'Relevant Hashtags (optional)', placeholder: '#handmade #artisan #assam' }
                    ]
                },
                facebook: {
                    title: 'Create a Facebook Post',
                    subtitle: 'Write a post to engage with your community on Facebook.',
                    btnText: 'Generate Post',
                    inputs: [
                        { type: 'textarea', id: 'prompt', label: 'What is this post about?', placeholder: 'e.g., Sharing the story behind the new collection.', rows: 4 },
                        { type: 'text', id: 'cta', label: 'Call to Action (optional)', placeholder: 'e.g., Visit our shop to see more!' }
                    ]
                },
                linkedin: {
                    title: 'Create a LinkedIn Post',
                    subtitle: 'Share a professional update about your craft or business.',
                    btnText: 'Generate Post',
                    inputs: [
                        { type: 'textarea', id: 'prompt', label: 'Professional Update or Topic', placeholder: 'e.g., Discussing the importance of sustainable materials in our craft.', rows: 4 },
                    ]
                },
                amazon: {
                    title: 'Create an Amazon Listing',
                    subtitle: 'Generate key bullet points for an Amazon product page.',
                    btnText: 'Generate Listing Points',
                    inputs: [
                        { type: 'textarea', id: 'prompt', label: 'Product Description', placeholder: 'Describe the product in detail.', rows: 4 },
                        { type: 'text', id: 'keywords', label: 'Primary Keywords', placeholder: 'e.g., hand carved rhino, wooden sculpture' }
                    ]
                }
            },
            image: {
                title: 'Generate an Image Prompt',
                subtitle: 'Create a detailed prompt for an AI image generator.',
                btnText: 'Generate Prompt',
                inputs: [
                    { type: 'textarea', id: 'prompt', label: 'Simple Image Idea', placeholder: 'e.g., A handmade ceramic mug with a blue glaze on a wooden table.', rows: 8 }
                ]
            },
            brand: {
                title: 'Brand Hub',
                subtitle: 'Define your core brand identity to ensure consistent content.',
                btnText: 'Save Brand Info',
                inputs: [
                    { type: 'text', id: 'brandName', label: 'Brand Name', placeholder: 'e.g., Assam Artisans' },
                    { type: 'textarea', id: 'brandValues', label: 'Brand Values & Mission', placeholder: 'e.g., To preserve traditional craftsmanship and support local communities...', rows: 4 },
                    { type: 'text', id: 'targetAudience', label: 'Target Audience', placeholder: 'e.g., Art collectors, lovers of handmade goods' },
                    { type: 'text', id: 'brandVoice', label: 'Brand Voice', placeholder: 'e.g., Elegant, rustic, warm, and authentic' }
                ]
            }
        };

        let activeSection = 'story';
        let activeSocialPlatform = 'instagram';

        const mainNav = document.getElementById('main-nav');
        const socialSubNav = document.getElementById('social-sub-nav');
        const workspaceTitle = document.getElementById('workspace-title');
        const workspaceSubtitle = document.getElementById('workspace-subtitle');
        const inputContainer = document.getElementById('input-container');
        const generateBtn = document.getElementById('generateBtn');
        const btnText = document.getElementById('btn-text');
        const outputDiv = document.getElementById('output');
        
        function renderInputs(inputsConfig) {
            inputContainer.innerHTML = '';
            inputsConfig.forEach(input => {
                const label = `<label for="${input.id}" class="block text-sm font-medium text-gray-700 mb-1">${input.label}</label>`;
                let inputElement;
                if (input.type === 'textarea') {
                    inputElement = `<textarea id="${input.id}" rows="${input.rows}" class="w-full p-3 bg-white/80 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition" placeholder="${input.placeholder}"></textarea>`;
                } else {
                    inputElement = `<input type="text" id="${input.id}" class="w-full p-3 bg-white/80 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition" placeholder="${input.placeholder}">`;
                }
                inputContainer.innerHTML += `<div class="mb-4">${label}${inputElement}</div>`;
            });
        }

        function renderWorkspace() {
            let config;
            if (activeSection === 'social') {
                config = workspaceConfig.social[activeSocialPlatform];
                socialSubNav.classList.remove('hidden');
            } else {
                config = workspaceConfig[activeSection];
                socialSubNav.classList.add('hidden');
            }

            workspaceTitle.textContent = config.title;
            workspaceSubtitle.textContent = config.subtitle;
            btnText.textContent = config.btnText;
            renderInputs(config.inputs);
        }

        mainNav.addEventListener('click', (e) => {
            const button = e.target.closest('.nav-btn');
            if (!button) return;

            activeSection = button.dataset.section;
            mainNav.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('nav-active', 'text-gray-600', 'hover:bg-gray-200/50');
                if (btn === button) {
                    btn.classList.add('nav-active');
                } else {
                    btn.classList.add('text-gray-600', 'hover:bg-gray-200/50');
                }
            });
            renderWorkspace();
        });
        
        socialSubNav.addEventListener('click', (e) => {
            const button = e.target.closest('.sub-nav-btn');
            if (!button) return;
            
            activeSocialPlatform = button.dataset.social;
            socialSubNav.querySelectorAll('.sub-nav-btn').forEach(btn => btn.classList.remove('sub-nav-active'));
            button.classList.add('sub-nav-active');
            renderWorkspace();
        });

        generateBtn.addEventListener('click', async () => {
            const loadingSpinner = document.getElementById('loadingSpinner');
            const inputs = inputContainer.querySelectorAll('input, textarea');
            let requestData = {};
            let hasContent = false;
            inputs.forEach(input => {
                requestData[input.id] = input.value;
                if (input.value.trim() !== '') hasContent = true;
            });
            
            if (!hasContent) {
                outputDiv.innerHTML = '<p class="text-red-500 font-medium fade-in">Please provide some input to generate content.</p>';
                return;
            }

            loadingSpinner.classList.remove('hidden');
            generateBtn.disabled = true;
            generateBtn.classList.add('opacity-70', 'cursor-not-allowed');
            outputDiv.innerHTML = '<p class="text-gray-500">Generating...</p>';

            try {
                // This is a placeholder endpoint. You'll need to create different endpoints
                // in your Flask app for each generator type.
                const endpoint = 'http://127.0.0.1:5000/generatestory';
                
                const response = await fetch(endpoint, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        section: activeSection,
                        platform: activeSection === 'social' ? activeSocialPlatform : null,
                        data: requestData
                    }),
                });

                const data = await response.json();
                outputDiv.innerHTML = '';

                if (response.ok) {
                    const contentElement = document.createElement('p');
                    contentElement.className = 'text-gray-800 fade-in';
                    contentElement.textContent = data.story || JSON.stringify(data, null, 2);
                    outputDiv.appendChild(contentElement);
                } else {
                    const errorElement = document.createElement('div');
                    errorElement.className = 'fade-in';
                    errorElement.innerHTML = `<p class="text-red-600 font-semibold">Error:</p><p class="text-red-500">${data.error || 'An unknown error occurred.'}</p>`;
                    outputDiv.appendChild(errorElement);
                }

            } catch (error) {
                console.error('Fetch Error:', error);
                outputDiv.innerHTML = '';
                const errorElement = document.createElement('div');
                errorElement.className = 'fade-in';
                errorElement.innerHTML = `<p class="text-red-600 font-semibold">Connection Error:</p><p class="text-red-500">Could not connect to the backend. Please ensure your Flask server is running.</p>`;
                outputDiv.appendChild(errorElement);
            } finally {
                loadingSpinner.classList.add('hidden');
                generateBtn.disabled = false;
                generateBtn.classList.remove('opacity-70', 'cursor-not-allowed');
            }
        });

        // Initial render
        renderWorkspace();
    </script>
</body>
</html>